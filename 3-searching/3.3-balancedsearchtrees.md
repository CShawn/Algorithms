# 3.3-平衡二叉查找树BalancedSearchTrees
二叉查找树在最差情况下会退化成链表，为了保证对数级的查找速度，需要保证二叉树的平衡，即保证二叉树任意结点的左右子树高度相差不大于1。

> 平衡二叉树：任意节点的子树的高度差都小于等于1的二叉树。

## 2-3查找树
一棵二叉树一般只允许结点中保存一个键，一个结点有两个子结点，这样的结点称为`2-`结点；我们扩展一下，让每个结点可存储两个键，并可以有三个子结点，称为`3-`结点。那么可以构建一棵`2-3`查找树，用它来实现二叉树的平衡。

### 查找
类似于二叉查找树的查找方式，将目标值与结点对比：
- 若结点为空，则返回空
- 若等于结点中其中一个的值，则返回
- 若比结点所有值小，则向左子树查找
- 若在结点存在两个值且目标值处于两个值中间，则向中子树查找
- 若比结点所有值大，则向右子树查找

### 插入
#### 向2-结点中插入新键
在二叉查找树中插入新键，会加入新结点，而无法保持平衡。在`2-3`树中插入时，若查找到要插入的结点为`2-`结点时，直接将键插入到该结点中，即保证了树的平衡。

#### 向3-结点中插入新键
向3-结点中插入新键需考虑以下几种情况：
##### 一棵只有一个3-结点的树
先从最简单的情况出发，若一棵树只有一个`3-`结点：
- 先将键插入`3-`结点，成为一个`4-`结点，具有4个子链接
- 将`4-`结点分解为一棵`2-3`树，首先找到三个键的中间值
- 将中值提升为父结点，左右子树为其他两个键值，分别带上4个子链接中的两个子链接

##### 3-结点的父结点为2-结点
步骤同上，但在将中值提升为父结点后，要把它放入父结点中。此时父结点中有两个键，符合树的定义，亦保持了树的平衡。

##### 3-结点的父结点为3-结点
步骤亦同上，将中值提升为父结点并放入父结点后，此时父结点也有了3个结点，需要将此结点再次拆分，提取中值向上成为父结点；当父结点中存在3个结点，则不断递归向上抽取。

可见，`2-3`树是自底向上增长的，并保证了二叉树的平衡性，特性是：任意空链接到根结点的路径长度都是相等的。

## 红黑二叉查找树
红黑二叉查找树是用标准的二叉查找树（完全由`2-`结点构成) 和一些额外的信息（替 换`3-`结点）来表示`2-3`树。我们将树中的链接分为两种类型：*红链接*将两个`2-`结点连接起来构成一个`3-`结点，*黑链接*则是`2-3`树中的普通链接。即将`3-`结点表示为由一条左斜的红色链接相连的两个`2-`结点。